<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Enviar plantilla "pedido"</title>
</head>
<body>
  <h1>Enviar plantilla "pedido"</h1>

  <label>Número WhatsApp (con código país, sin +):</label><br>
  <input type="text" id="numero" value="529514138990"><br><br>

  <label>Nombre del cliente:</label><br>
  <input type="text" id="cliente" value="John"><br><br>

  <label>ID Pedido:</label><br>
  <input type="text" id="pedido" value="#12345"><br><br>

  <button onclick="enviar()">Enviar plantilla</button>

  <script>
    async function enviar() {
      const numero = document.getElementById("numero").value;
      const nombre = document.getElementById("cliente").value;
      const pedido = document.getElementById("pedido").value;

      const url = "https://graph.facebook.com/v19.0/743724888825070/messages";
      const token = "EAAXIU6wZCx14BPDTEXacG3OTZAeOhty54qEq7GSWMtoODBwAwpGF1j30jOtwPIsGv93iZCtcsGqIXLzrDNUXC03K0gVmQ0t34bPuZCzsV7puxqf16Tr6Hsgq9kDthL9yN8d9EC0SbHbpMZAiXB3gH3g2bP1OWIF1kNtOqTuEmGSVSnDlDr8wBXTdmG5eF9ZBznPNvc9r7kI3Jt63YMkL7cPXjiTa9izvjCZBbokqOEHVr8ZAAUjDZBtEsNVGyhs4ZAtgZDZD";

      const body = {
        messaging_product: "whatsapp",
        to: numero,
        type: "template",
        template: {
          name: "pedido",
          language: { code: "es" },
          components: [{
            type: "body",
            parameters: [
              { type: "text", text: nombre },
              { type: "text", text: pedido }
            ]
          }]
        }
      };

      try {
        const res = await fetch(url, {
          method: "POST",
          headers: {
            "Authorization": "Bearer " + token,
            "Content-Type": "application/json"
          },
          body: JSON.stringify(body)
        });

        const data = await res.json();
        console.log("Respuesta de WhatsApp:", data);
        alert("Plantilla enviada. Revisa la consola.");
      } catch (err) {
        console.error("Error:", err);
        alert("Error al enviar la plantilla.");
      }
    }
  </script>
</body>
</html>
