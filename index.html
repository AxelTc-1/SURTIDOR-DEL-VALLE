<!DOCTYPE html>
<html>
<head>
  <title>Enviar plantilla WhatsApp con ubicación</title>
</head>
<body>
  <h1>Enviar plantilla "lola" con ubicación</h1>
  <button onclick="enviarMensaje()">Enviar</button>

  <script>
    async function enviarMensaje() {
      const url = 'https://graph.facebook.com/v19.0/743724888825070/messages';
      const token = 'EAAXIU6wZCx14BPIbIp7VOgAvmbodcp07LUsUzsZC01dHbjj05tGHaNBpjOsJxoUZC60lwY7TpKeuX3RkwZCl6tmcwC1VvTEAS8FPjGjGZCAzCbkQBpBB3kIZAoo3ts9S7GyrgHOBGC31ud7Y4TLpaVPx7ki8CHb2lyiohbyfSFOE4HPQ7jXuzcw5DgPfiOgNYoygZDZD';

      const data = {
        messaging_product: 'whatsapp',
        to: '529514138990',
        type: 'template',
        template: {
          name: 'lola',
          language: { code: 'es_MX' },
          components: [
            {
              type: 'header',
              parameters: [
                {
                  type: 'location',
                  location: {
                    longitude: -99.1332,
                    latitude: 19.4326,
                    name: 'Ciudad de México',
                    address: 'Centro histórico, CDMX'
                  }
                }
              ]
            }
          ]
        }
      };

      try {
        const response = await fetch(url, {
          method: 'POST',
          headers: {
            'Authorization': 'Bearer ' + token,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        });

        if (response.ok) {
          const result = await response.json();
          console.log(result);
          // Redirige a mapas.html después de enviar el mensaje con éxito
          window.location.href = 'mapas.html';
        } else {
          const errorResult = await response.json();
          console.error('Error en la respuesta de la API:', errorResult);
          alert('Error en la respuesta: ' + JSON.stringify(errorResult));
        }
      } catch (error) {
        console.error('Error al enviar mensaje:', error);
        alert('Error: ' + error.message);
      }
    }
  </script>
</body>
</html>

